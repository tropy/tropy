@use "../../abstracts/config" as *;

//
// Esper overlay
// --------------------------------------------------

.esper-overlay {
  flex: 1 1 0;
  display: grid;
  grid-template-columns: auto 0;
  grid-template-rows: $toolbar-height auto;
  background-color: $esper-bg;
  transition: grid 0.3s ease;

  &.full {
    position: absolute;
    inset: 0;
    z-index: $zindex-esper-header;
  }

  &.transcription-panel-visible {
    grid-template-columns: auto $esper-panel-width;
  }

  .side-by-side .text-overlay-split &,
  .side-by-side:not(.esper-maximized) .text-overlay-full & {
    grid-template-columns: auto;
    grid-template-rows: $toolbar-height auto 0;

    &.transcription-panel-visible {
      grid-template-rows: $toolbar-height auto $esper-panel-height;
    }
  }

  .toolbar {
    grid-column: 1 / -1;
    box-shadow: 0 1px 0 $esper-shadow;
    position: relative;
    z-index: 1;

    .frameless & {
      height: zoom($toolbar-frameless-height);

      @if $platform == win32 {
        height: zoom($toolbar-height);
      }
    }

    .toolbar-right {
      @if $platform == darwin {
        .stacked .text-overlay-full &,
        .side-by-side.esper-maximized & {
          .window-controls-right:not(.is-full-screen) & {
            flex: 1 1 0;
            overflow: hidden;
            margin-right: zoom($window-controls-width + $space-sm);
          }
        }
      }

      @if $platform == win32 {
        .stacked .text-overlay-full &,
        .side-by-side.esper-maximized & {
          .window-controls-left:not(.is-full-screen:not(.full-screen-menu)) & {
            flex: 1 1 0;
            overflow: hidden;
            margin-right: zoom(48px + 24px);
          }

          .window-controls-right:not(.is-full-screen) & {
            flex: 1 1 0;
            overflow: hidden;
            margin-right: zoom($window-controls-width + $space-sm);
          }
        }
      }

      @if $platform == linux {
        .stacked .text-overlay-full &,
        .side-by-side.esper-maximized & {
          .frameless & {
            flex: 1 1 0;
            overflow: hidden;

            .window-controls-left :is(&) {
              margin-right: zoom(52px);
            }

            .window-controls-right :is(&) {
              margin-right: zoom($window-controls-width + $space-sm);

              .window-controls-minimize :is(&),
              .frameless.window-controls-maximize :is(&) {
                margin-right: zoom($window-controls-width + 37px + $space-sm);
              }

              .window-controls-minimize.window-controls-maximize :is(&) {
                margin-right: zoom($window-controls-width + 37px + 37px + $space-sm);
              }
            }
          }
        }
      }
    }
  }
}
